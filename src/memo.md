## 2025-04-05

### パッケージの「runBoth」機能（ユニットテストと E2E テストの両方を実行）の修正

**問題点：**

- パッケージの runBoth オプションでユニットテストと E2E テストを実行すると、テストが見つからないエラーが発生していた
- `No tests found, exiting with code 1` エラーが発生していた
- テストファイルのパターンマッチが正しく機能していなかった

**修正内容：**

1. テストパターンの指定方法を変更
   - 絶対パスを使った複雑な正規表現から、相対パスベースの `--testMatch` パターンに変更
   - 拡張子指定を `(ts|tsx|js|jsx)` から `{ts,tsx,js,jsx}` に修正
2. コマンド実行方法の改善

   - セミコロン `;` からアンパサンド `&&` にコマンド連結方法を変更
   - カスタムコマンド実行時のエスケープ処理を簡素化
   - シェルを `/bin/sh` から `bash` に変更してコマンド解釈の問題を回避

3. E2E テスト除外方法の改善
   - 通常テスト実行時に E2E テストを明示的に除外するフラグを追加

修正により、パッケージ単位でユニットテストと E2E テストの両方を順番に実行する機能が正常に動作するようになりました。

### 追加修正: コマンド実行時の環境変数設定の改善

**問題点:**

- 環境変数に JSON を含むようなデバッグ設定を渡す際に、bash での構文エラーが発生していた
- 特に `VSCODE_INSPECTOR_OPTIONS` 内のダブルクォートやカッコが正しく解釈されない問題

**修正内容:**

- `/usr/bin/env` コマンドを使用して、環境変数の設定をコマンドラインから分離
- 環境変数と bash コマンドを別々の引数として渡すように変更
- bash へのコマンド渡し方を簡素化し、エスケープの問題を回避

この修正により、複雑な JSON を含む環境変数を使用したテスト実行が正しく動作するようになりました。
