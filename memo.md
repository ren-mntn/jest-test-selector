## 2023-11-08: runTest 関数のリファクタリング

`src/testRunner.ts`の`runTest`関数をリファクタリングしました。

変更内容:

- 巨大な条件分岐を持つ単一の関数から、スコープタイプごとに分離された関数に変更
- `runPackageTests`、`runDirectoryTests`、`runFileTests`、`runSingleTest`の 4 つの関数に分割
- switch 文を使って各スコープタイプに対応する処理を呼び出す構造に変更
- コード全体の可読性と保守性が向上

コンパイルテストを実行し、問題なく動作することを確認しました。

## test.only の検出機能改善

test.only を記述コード上から削除しても警告表示や赤背景ハイライトが消えない問題を修正しました。

### 実装内容

1. **ファイル変更の即時反映**

   - テキスト変更を検知するリスナーを追加し、テストファイル変更時に即座に`.only`検出処理を再実行
   - 編集中のファイルのみを対象とした軽量な更新処理（`updateTestFile`メソッド）を追加

2. **`.only`検出ロジックの改善**

   - `.only`位置情報を完全にリセットするのではなく、変更されたファイルの情報のみを更新するよう変更
   - 全体的な`.only`検出状態を`.only`の位置情報リストの長さに基づいて判定するよう修正

3. **ステータスバー表示の最適化**
   - ファイル変更直後に検出状態を更新することで、`.only`削除後すぐに警告表示を消去

### 効果

- test.only を削除した直後に警告表示と赤背景ハイライトが消去されるようになり、ユーザー体験が向上
- 複数ファイルに`.only`が存在する場合も正確に状態管理ができるようになり、誤検知を防止
